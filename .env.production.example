# ============================================================================
# AgentPay Production Environment Configuration
# ============================================================================
# Copy this file to .env.production and fill in the values
# NEVER commit .env.production to git (it's in .gitignore)
# ============================================================================

# ============================================================================
# CORE APPLICATION SETTINGS
# ============================================================================

# Environment (production, staging, development)
POLAR_ENV=production

# Secret key for session encryption (generate with: openssl rand -hex 32)
POLAR_SECRET=

# Base URL for the application (e.g., https://agentpay.yourdomain.com)
POLAR_BASE_URL=

# CORS allowed origins (comma-separated, e.g., https://shop1.com,https://shop2.com)
POLAR_CORS_ORIGINS=

# ============================================================================
# DATABASE CONFIGURATION (PostgreSQL with pgvector)
# ============================================================================

# PostgreSQL connection string
# Format: postgresql+asyncpg://user:password@host:port/database
# Managed providers: Render, Railway, Neon, Supabase, AWS RDS
POLAR_POSTGRES_DSN=postgresql+asyncpg://agentpay:PASSWORD@HOST:5432/agentpay_production

# Connection pool settings
POLAR_POSTGRES_POOL_SIZE=20
POLAR_POSTGRES_MAX_OVERFLOW=10

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================

# Redis URL for caching and job queue
# Format: redis://user:password@host:port/db
# Managed providers: Upstash, Redis Cloud, AWS ElastiCache
POLAR_REDIS_URL=redis://:PASSWORD@HOST:6379/0

# ============================================================================
# LLM CONFIGURATION (Anthropic Claude)
# ============================================================================

# Anthropic API Key (get from: https://console.anthropic.com/)
# Required for: Agent responses, intent classification
ANTHROPIC_API_KEY=sk-ant-api03-...

# Default model for agent responses
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022

# Model for intent classification (cheaper, faster)
ANTHROPIC_INTENT_MODEL=claude-3-haiku-20240307

# Temperature for response generation (0.0-1.0, default: 0.7)
ANTHROPIC_TEMPERATURE=0.7

# Max tokens per response (default: 1024)
ANTHROPIC_MAX_TOKENS=1024

# Enable prompt caching (recommended for production, saves 17% cost)
ANTHROPIC_ENABLE_CACHING=true

# ============================================================================
# LLM CONFIGURATION (OpenAI - Fallback & Embeddings)
# ============================================================================

# OpenAI API Key (get from: https://platform.openai.com/api-keys)
# Required for: Embeddings, fallback LLM
OPENAI_API_KEY=sk-proj-...

# Model for embeddings (text-embedding-3-small recommended)
OPENAI_EMBEDDING_MODEL=text-embedding-3-small

# Fallback LLM model (if Anthropic is down)
OPENAI_FALLBACK_MODEL=gpt-4o

# ============================================================================
# STRIPE PAYMENT CONFIGURATION
# ============================================================================

# Stripe Secret Key (Live mode)
# Get from: https://dashboard.stripe.com/apikeys
POLAR_STRIPE_SECRET_KEY=sk_live_...

# Stripe Publishable Key (Live mode)
POLAR_STRIPE_PUBLISHABLE_KEY=pk_live_...

# Stripe Webhook Secret (for direct webhooks)
# Get from: https://dashboard.stripe.com/webhooks
POLAR_STRIPE_WEBHOOK_SECRET=whsec_live_...

# Stripe Connect Webhook Secret (for Connect webhooks)
POLAR_STRIPE_CONNECT_WEBHOOK_SECRET=whsec_live_...

# ============================================================================
# S3 / OBJECT STORAGE CONFIGURATION
# ============================================================================

# S3-compatible storage (AWS S3, Cloudflare R2, DigitalOcean Spaces, Minio)
S3_ENDPOINT_URL=https://s3.amazonaws.com
S3_ACCESS_KEY_ID=
S3_SECRET_ACCESS_KEY=
S3_BUCKET_NAME=agentpay-production
S3_REGION=us-east-1

# ============================================================================
# GITHUB INTEGRATION (Optional)
# ============================================================================

# GitHub App credentials (if using GitHub auth)
# Get from: https://github.com/settings/apps
POLAR_GITHUB_APP_ID=
POLAR_GITHUB_APP_PRIVATE_KEY=
POLAR_GITHUB_CLIENT_ID=
POLAR_GITHUB_CLIENT_SECRET=

# ============================================================================
# MONITORING & OBSERVABILITY
# ============================================================================

# Sentry DSN for error tracking (optional but recommended)
# Get from: https://sentry.io/
SENTRY_DSN=

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Datadog API key (optional)
DATADOG_API_KEY=

# ============================================================================
# EMAIL CONFIGURATION (Optional)
# ============================================================================

# Email provider settings (for transactional emails)
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=noreply@yourdomain.com

# ============================================================================
# AGENTPAY SPECIFIC SETTINGS
# ============================================================================

# Enable agent streaming responses (SSE + WebSocket)
AGENTPAY_ENABLE_STREAMING=true

# Enable agent typing indicators
AGENTPAY_ENABLE_TYPING_INDICATORS=true

# Maximum conversation history length (for context)
AGENTPAY_MAX_HISTORY_LENGTH=20

# RAG similarity threshold (0.0-1.0, higher = more relevant)
AGENTPAY_RAG_SIMILARITY_THRESHOLD=0.75

# RAG max results per query
AGENTPAY_RAG_MAX_RESULTS=5

# Cache TTL for embeddings (seconds, default: 3600 = 1 hour)
AGENTPAY_EMBEDDING_CACHE_TTL=3600

# ============================================================================
# WORKER CONFIGURATION (Dramatiq)
# ============================================================================

# Number of worker threads per process
WORKER_THREADS=4

# Worker concurrency level
WORKER_CONCURRENCY=10

# ============================================================================
# RATE LIMITING
# ============================================================================

# Rate limit for API requests (requests per minute)
RATE_LIMIT_PER_MINUTE=60

# Rate limit for chat messages (messages per minute per conversation)
CHAT_RATE_LIMIT_PER_MINUTE=10

# ============================================================================
# SECURITY SETTINGS
# ============================================================================

# Enable HTTPS only (recommended for production)
FORCE_HTTPS=true

# Session cookie settings
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=lax

# CSRF protection
CSRF_ENABLED=true

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Enable multi-agent routing (future feature)
ENABLE_MULTI_AGENT=false

# Enable conversation analytics
ENABLE_ANALYTICS=true

# Enable A/B testing framework
ENABLE_AB_TESTING=false

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================

# Database query timeout (seconds)
DB_QUERY_TIMEOUT=30

# LLM request timeout (seconds)
LLM_REQUEST_TIMEOUT=60

# Redis connection timeout (seconds)
REDIS_TIMEOUT=5

# HTTP client timeout (seconds)
HTTP_CLIENT_TIMEOUT=30
