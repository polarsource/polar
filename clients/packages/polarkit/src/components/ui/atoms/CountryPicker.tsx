'use client'

import { Command } from 'cmdk'
import { CONFIG } from 'polarkit'
import { useState } from 'react'
import { twMerge } from 'tailwind-merge'

import { Check, ChevronsUpDown } from 'lucide-react'
import React from 'react'
import {
  CommandEmpty,
  CommandGroup,
  CommandInput,
  CommandItem,
} from '../command'
import { Popover, PopoverContent, PopoverTrigger } from '../popover'
import { RawButton } from './Button'

const countryWhiteList = CONFIG.STRIPE_COUNTRIES_WHITELIST_CSV.split(',')

const countries = [
  ['AF', { emoji: 'ğŸ‡¦ğŸ‡«', name: 'Afghanistan' }],
  ['AX', { emoji: 'ğŸ‡¦ğŸ‡½', name: 'Ã…land' }],
  ['AL', { emoji: 'ğŸ‡¦ğŸ‡±', name: 'Albania' }],
  ['DZ', { emoji: 'ğŸ‡©ğŸ‡¿', name: 'Algeria' }],
  ['AS', { emoji: 'ğŸ‡¦ğŸ‡¸', name: 'American Samoa' }],
  ['AD', { emoji: 'ğŸ‡¦ğŸ‡©', name: 'Andorra' }],
  ['AO', { emoji: 'ğŸ‡¦ğŸ‡´', name: 'Angola' }],
  ['AI', { emoji: 'ğŸ‡¦ğŸ‡®', name: 'Anguilla' }],
  ['AQ', { emoji: 'ğŸ‡¦ğŸ‡¶', name: 'Antarctica' }],
  ['AG', { emoji: 'ğŸ‡¦ğŸ‡¬', name: 'Antigua and Barbuda' }],
  ['AR', { emoji: 'ğŸ‡¦ğŸ‡·', name: 'Argentina' }],
  ['AM', { emoji: 'ğŸ‡¦ğŸ‡²', name: 'Armenia' }],
  ['AW', { emoji: 'ğŸ‡¦ğŸ‡¼', name: 'Aruba' }],
  ['AU', { emoji: 'ğŸ‡¦ğŸ‡º', name: 'Australia' }],
  ['AT', { emoji: 'ğŸ‡¦ğŸ‡¹', name: 'Austria' }],
  ['AZ', { emoji: 'ğŸ‡¦ğŸ‡¿', name: 'Azerbaijan' }],
  ['BS', { emoji: 'ğŸ‡§ğŸ‡¸', name: 'Bahamas' }],
  ['BH', { emoji: 'ğŸ‡§ğŸ‡­', name: 'Bahrain' }],
  ['BD', { emoji: 'ğŸ‡§ğŸ‡©', name: 'Bangladesh' }],
  ['BB', { emoji: 'ğŸ‡§ğŸ‡§', name: 'Barbados' }],
  ['BY', { emoji: 'ğŸ‡§ğŸ‡¾', name: 'Belarus' }],
  ['BE', { emoji: 'ğŸ‡§ğŸ‡ª', name: 'Belgium' }],
  ['BZ', { emoji: 'ğŸ‡§ğŸ‡¿', name: 'Belize' }],
  ['BJ', { emoji: 'ğŸ‡§ğŸ‡¯', name: 'Benin' }],
  ['BM', { emoji: 'ğŸ‡§ğŸ‡²', name: 'Bermuda' }],
  ['BT', { emoji: 'ğŸ‡§ğŸ‡¹', name: 'Bhutan' }],
  ['BO', { emoji: 'ğŸ‡§ğŸ‡´', name: 'Bolivia' }],
  ['BQ', { emoji: 'ğŸ‡§ğŸ‡¶', name: 'Bonaire' }],
  ['BA', { emoji: 'ğŸ‡§ğŸ‡¦', name: 'Bosnia and Herzegovina' }],
  ['BW', { emoji: 'ğŸ‡§ğŸ‡¼', name: 'Botswana' }],
  ['BV', { emoji: 'ğŸ‡§ğŸ‡»', name: 'Bouvet Island' }],
  ['BR', { emoji: 'ğŸ‡§ğŸ‡·', name: 'Brazil' }],
  ['IO', { emoji: 'ğŸ‡®ğŸ‡´', name: 'British Indian Ocean Territory' }],
  ['VG', { emoji: 'ğŸ‡»ğŸ‡¬', name: 'British Virgin Islands' }],
  ['BN', { emoji: 'ğŸ‡§ğŸ‡³', name: 'Brunei' }],
  ['BG', { emoji: 'ğŸ‡§ğŸ‡¬', name: 'Bulgaria' }],
  ['BF', { emoji: 'ğŸ‡§ğŸ‡«', name: 'Burkina Faso' }],
  ['BI', { emoji: 'ğŸ‡§ğŸ‡®', name: 'Burundi' }],
  ['KH', { emoji: 'ğŸ‡°ğŸ‡­', name: 'Cambodia' }],
  ['CM', { emoji: 'ğŸ‡¨ğŸ‡²', name: 'Cameroon' }],
  ['CA', { emoji: 'ğŸ‡¨ğŸ‡¦', name: 'Canada' }],
  ['CV', { emoji: 'ğŸ‡¨ğŸ‡»', name: 'Cape Verde' }],
  ['KY', { emoji: 'ğŸ‡°ğŸ‡¾', name: 'Cayman Islands' }],
  ['CF', { emoji: 'ğŸ‡¨ğŸ‡«', name: 'Central African Republic' }],
  ['TD', { emoji: 'ğŸ‡¹ğŸ‡©', name: 'Chad' }],
  ['CL', { emoji: 'ğŸ‡¨ğŸ‡±', name: 'Chile' }],
  ['CN', { emoji: 'ğŸ‡¨ğŸ‡³', name: 'China' }],
  ['CX', { emoji: 'ğŸ‡¨ğŸ‡½', name: 'Christmas Island' }],
  ['CC', { emoji: 'ğŸ‡¨ğŸ‡¨', name: 'Cocos [Keeling] Islands' }],
  ['CO', { emoji: 'ğŸ‡¨ğŸ‡´', name: 'Colombia' }],
  ['KM', { emoji: 'ğŸ‡°ğŸ‡²', name: 'Comoros' }],
  ['CK', { emoji: 'ğŸ‡¨ğŸ‡°', name: 'Cook Islands' }],
  ['CR', { emoji: 'ğŸ‡¨ğŸ‡·', name: 'Costa Rica' }],
  ['HR', { emoji: 'ğŸ‡­ğŸ‡·', name: 'Croatia' }],
  ['CU', { emoji: 'ğŸ‡¨ğŸ‡º', name: 'Cuba' }],
  ['CW', { emoji: 'ğŸ‡¨ğŸ‡¼', name: 'Curacao' }],
  ['CY', { emoji: 'ğŸ‡¨ğŸ‡¾', name: 'Cyprus' }],
  ['CZ', { emoji: 'ğŸ‡¨ğŸ‡¿', name: 'Czech Republic' }],
  ['CD', { emoji: 'ğŸ‡¨ğŸ‡©', name: 'Democratic Republic of the Congo' }],
  ['DK', { emoji: 'ğŸ‡©ğŸ‡°', name: 'Denmark' }],
  ['DJ', { emoji: 'ğŸ‡©ğŸ‡¯', name: 'Djibouti' }],
  ['DM', { emoji: 'ğŸ‡©ğŸ‡²', name: 'Dominica' }],
  ['DO', { emoji: 'ğŸ‡©ğŸ‡´', name: 'Dominican Republic' }],
  ['TL', { emoji: 'ğŸ‡¹ğŸ‡±', name: 'East Timor' }],
  ['EC', { emoji: 'ğŸ‡ªğŸ‡¨', name: 'Ecuador' }],
  ['EG', { emoji: 'ğŸ‡ªğŸ‡¬', name: 'Egypt' }],
  ['SV', { emoji: 'ğŸ‡¸ğŸ‡»', name: 'El Salvador' }],
  ['GQ', { emoji: 'ğŸ‡¬ğŸ‡¶', name: 'Equatorial Guinea' }],
  ['ER', { emoji: 'ğŸ‡ªğŸ‡·', name: 'Eritrea' }],
  ['EE', { emoji: 'ğŸ‡ªğŸ‡ª', name: 'Estonia' }],
  ['ET', { emoji: 'ğŸ‡ªğŸ‡¹', name: 'Ethiopia' }],
  ['FK', { emoji: 'ğŸ‡«ğŸ‡°', name: 'Falkland Islands' }],
  ['FO', { emoji: 'ğŸ‡«ğŸ‡´', name: 'Faroe Islands' }],
  ['FJ', { emoji: 'ğŸ‡«ğŸ‡¯', name: 'Fiji' }],
  ['FI', { emoji: 'ğŸ‡«ğŸ‡®', name: 'Finland' }],
  ['FR', { emoji: 'ğŸ‡«ğŸ‡·', name: 'France' }],
  ['GF', { emoji: 'ğŸ‡¬ğŸ‡«', name: 'French Guiana' }],
  ['PF', { emoji: 'ğŸ‡µğŸ‡«', name: 'French Polynesia' }],
  ['TF', { emoji: 'ğŸ‡¹ğŸ‡«', name: 'French Southern Territories' }],
  ['GA', { emoji: 'ğŸ‡¬ğŸ‡¦', name: 'Gabon' }],
  ['GM', { emoji: 'ğŸ‡¬ğŸ‡²', name: 'Gambia' }],
  ['GE', { emoji: 'ğŸ‡¬ğŸ‡ª', name: 'Georgia' }],
  ['DE', { emoji: 'ğŸ‡©ğŸ‡ª', name: 'Germany' }],
  ['GH', { emoji: 'ğŸ‡¬ğŸ‡­', name: 'Ghana' }],
  ['GI', { emoji: 'ğŸ‡¬ğŸ‡®', name: 'Gibraltar' }],
  ['GR', { emoji: 'ğŸ‡¬ğŸ‡·', name: 'Greece' }],
  ['GL', { emoji: 'ğŸ‡¬ğŸ‡±', name: 'Greenland' }],
  ['GD', { emoji: 'ğŸ‡¬ğŸ‡©', name: 'Grenada' }],
  ['GP', { emoji: 'ğŸ‡¬ğŸ‡µ', name: 'Guadeloupe' }],
  ['GU', { emoji: 'ğŸ‡¬ğŸ‡º', name: 'Guam' }],
  ['GT', { emoji: 'ğŸ‡¬ğŸ‡¹', name: 'Guatemala' }],
  ['GG', { emoji: 'ğŸ‡¬ğŸ‡¬', name: 'Guernsey' }],
  ['GN', { emoji: 'ğŸ‡¬ğŸ‡³', name: 'Guinea' }],
  ['GW', { emoji: 'ğŸ‡¬ğŸ‡¼', name: 'Guinea-Bissau' }],
  ['GY', { emoji: 'ğŸ‡¬ğŸ‡¾', name: 'Guyana' }],
  ['HT', { emoji: 'ğŸ‡­ğŸ‡¹', name: 'Haiti' }],
  ['HM', { emoji: 'ğŸ‡­ğŸ‡²', name: 'Heard Island and McDonald Islands' }],
  ['HN', { emoji: 'ğŸ‡­ğŸ‡³', name: 'Honduras' }],
  ['HK', { emoji: 'ğŸ‡­ğŸ‡°', name: 'Hong Kong' }],
  ['HU', { emoji: 'ğŸ‡­ğŸ‡º', name: 'Hungary' }],
  ['IS', { emoji: 'ğŸ‡®ğŸ‡¸', name: 'Iceland' }],
  ['IN', { emoji: 'ğŸ‡®ğŸ‡³', name: 'India' }],
  ['ID', { emoji: 'ğŸ‡®ğŸ‡©', name: 'Indonesia' }],
  ['IR', { emoji: 'ğŸ‡®ğŸ‡·', name: 'Iran' }],
  ['IQ', { emoji: 'ğŸ‡®ğŸ‡¶', name: 'Iraq' }],
  ['IE', { emoji: 'ğŸ‡®ğŸ‡ª', name: 'Ireland' }],
  ['IM', { emoji: 'ğŸ‡®ğŸ‡²', name: 'Isle of Man' }],
  ['IL', { emoji: 'ğŸ‡®ğŸ‡±', name: 'Israel' }],
  ['IT', { emoji: 'ğŸ‡®ğŸ‡¹', name: 'Italy' }],
  ['CI', { emoji: 'ğŸ‡¨ğŸ‡®', name: 'Ivory Coast' }],
  ['JM', { emoji: 'ğŸ‡¯ğŸ‡²', name: 'Jamaica' }],
  ['JP', { emoji: 'ğŸ‡¯ğŸ‡µ', name: 'Japan' }],
  ['JE', { emoji: 'ğŸ‡¯ğŸ‡ª', name: 'Jersey' }],
  ['JO', { emoji: 'ğŸ‡¯ğŸ‡´', name: 'Jordan' }],
  ['KZ', { emoji: 'ğŸ‡°ğŸ‡¿', name: 'Kazakhstan' }],
  ['KE', { emoji: 'ğŸ‡°ğŸ‡ª', name: 'Kenya' }],
  ['KI', { emoji: 'ğŸ‡°ğŸ‡®', name: 'Kiribati' }],
  ['XK', { emoji: 'ğŸ‡½ğŸ‡°', name: 'Kosovo' }],
  ['KW', { emoji: 'ğŸ‡°ğŸ‡¼', name: 'Kuwait' }],
  ['KG', { emoji: 'ğŸ‡°ğŸ‡¬', name: 'Kyrgyzstan' }],
  ['LA', { emoji: 'ğŸ‡±ğŸ‡¦', name: 'Laos' }],
  ['LV', { emoji: 'ğŸ‡±ğŸ‡»', name: 'Latvia' }],
  ['LB', { emoji: 'ğŸ‡±ğŸ‡§', name: 'Lebanon' }],
  ['LS', { emoji: 'ğŸ‡±ğŸ‡¸', name: 'Lesotho' }],
  ['LR', { emoji: 'ğŸ‡±ğŸ‡·', name: 'Liberia' }],
  ['LY', { emoji: 'ğŸ‡±ğŸ‡¾', name: 'Libya' }],
  ['LI', { emoji: 'ğŸ‡±ğŸ‡®', name: 'Liechtenstein' }],
  ['LT', { emoji: 'ğŸ‡±ğŸ‡¹', name: 'Lithuania' }],
  ['LU', { emoji: 'ğŸ‡±ğŸ‡º', name: 'Luxembourg' }],
  ['MO', { emoji: 'ğŸ‡²ğŸ‡´', name: 'Macao' }],
  ['MG', { emoji: 'ğŸ‡²ğŸ‡¬', name: 'Madagascar' }],
  ['MW', { emoji: 'ğŸ‡²ğŸ‡¼', name: 'Malawi' }],
  ['MY', { emoji: 'ğŸ‡²ğŸ‡¾', name: 'Malaysia' }],
  ['MV', { emoji: 'ğŸ‡²ğŸ‡»', name: 'Maldives' }],
  ['ML', { emoji: 'ğŸ‡²ğŸ‡±', name: 'Mali' }],
  ['MT', { emoji: 'ğŸ‡²ğŸ‡¹', name: 'Malta' }],
  ['MH', { emoji: 'ğŸ‡²ğŸ‡­', name: 'Marshall Islands' }],
  ['MQ', { emoji: 'ğŸ‡²ğŸ‡¶', name: 'Martinique' }],
  ['MR', { emoji: 'ğŸ‡²ğŸ‡·', name: 'Mauritania' }],
  ['MU', { emoji: 'ğŸ‡²ğŸ‡º', name: 'Mauritius' }],
  ['YT', { emoji: 'ğŸ‡¾ğŸ‡¹', name: 'Mayotte' }],
  ['MX', { emoji: 'ğŸ‡²ğŸ‡½', name: 'Mexico' }],
  ['FM', { emoji: 'ğŸ‡«ğŸ‡²', name: 'Micronesia' }],
  ['MD', { emoji: 'ğŸ‡²ğŸ‡©', name: 'Moldova' }],
  ['MC', { emoji: 'ğŸ‡²ğŸ‡¨', name: 'Monaco' }],
  ['MN', { emoji: 'ğŸ‡²ğŸ‡³', name: 'Mongolia' }],
  ['ME', { emoji: 'ğŸ‡²ğŸ‡ª', name: 'Montenegro' }],
  ['MS', { emoji: 'ğŸ‡²ğŸ‡¸', name: 'Montserrat' }],
  ['MA', { emoji: 'ğŸ‡²ğŸ‡¦', name: 'Morocco' }],
  ['MZ', { emoji: 'ğŸ‡²ğŸ‡¿', name: 'Mozambique' }],
  ['MM', { emoji: 'ğŸ‡²ğŸ‡²', name: 'Myanmar [Burma]' }],
  ['NA', { emoji: 'ğŸ‡³ğŸ‡¦', name: 'Namibia' }],
  ['NR', { emoji: 'ğŸ‡³ğŸ‡·', name: 'Nauru' }],
  ['NP', { emoji: 'ğŸ‡³ğŸ‡µ', name: 'Nepal' }],
  ['NL', { emoji: 'ğŸ‡³ğŸ‡±', name: 'Netherlands' }],
  ['NC', { emoji: 'ğŸ‡³ğŸ‡¨', name: 'New Caledonia' }],
  ['NZ', { emoji: 'ğŸ‡³ğŸ‡¿', name: 'New Zealand' }],
  ['NI', { emoji: 'ğŸ‡³ğŸ‡®', name: 'Nicaragua' }],
  ['NE', { emoji: 'ğŸ‡³ğŸ‡ª', name: 'Niger' }],
  ['NG', { emoji: 'ğŸ‡³ğŸ‡¬', name: 'Nigeria' }],
  ['NU', { emoji: 'ğŸ‡³ğŸ‡º', name: 'Niue' }],
  ['NF', { emoji: 'ğŸ‡³ğŸ‡«', name: 'Norfolk Island' }],
  ['KP', { emoji: 'ğŸ‡°ğŸ‡µ', name: 'North Korea' }],
  ['MK', { emoji: 'ğŸ‡²ğŸ‡°', name: 'North Macedonia' }],
  ['MP', { emoji: 'ğŸ‡²ğŸ‡µ', name: 'Northern Mariana Islands' }],
  ['NO', { emoji: 'ğŸ‡³ğŸ‡´', name: 'Norway' }],
  ['OM', { emoji: 'ğŸ‡´ğŸ‡²', name: 'Oman' }],
  ['PK', { emoji: 'ğŸ‡µğŸ‡°', name: 'Pakistan' }],
  ['PW', { emoji: 'ğŸ‡µğŸ‡¼', name: 'Palau' }],
  ['PS', { emoji: 'ğŸ‡µğŸ‡¸', name: 'Palestine' }],
  ['PA', { emoji: 'ğŸ‡µğŸ‡¦', name: 'Panama' }],
  ['PG', { emoji: 'ğŸ‡µğŸ‡¬', name: 'Papua New Guinea' }],
  ['PY', { emoji: 'ğŸ‡µğŸ‡¾', name: 'Paraguay' }],
  ['PE', { emoji: 'ğŸ‡µğŸ‡ª', name: 'Peru' }],
  ['PH', { emoji: 'ğŸ‡µğŸ‡­', name: 'Philippines' }],
  ['PN', { emoji: 'ğŸ‡µğŸ‡³', name: 'Pitcairn Islands' }],
  ['PL', { emoji: 'ğŸ‡µğŸ‡±', name: 'Poland' }],
  ['PT', { emoji: 'ğŸ‡µğŸ‡¹', name: 'Portugal' }],
  ['PR', { emoji: 'ğŸ‡µğŸ‡·', name: 'Puerto Rico' }],
  ['QA', { emoji: 'ğŸ‡¶ğŸ‡¦', name: 'Qatar' }],
  ['CG', { emoji: 'ğŸ‡¨ğŸ‡¬', name: 'Republic of the Congo' }],
  ['RE', { emoji: 'ğŸ‡·ğŸ‡ª', name: 'RÃ©union' }],
  ['RO', { emoji: 'ğŸ‡·ğŸ‡´', name: 'Romania' }],
  ['RU', { emoji: 'ğŸ‡·ğŸ‡º', name: 'Russia' }],
  ['RW', { emoji: 'ğŸ‡·ğŸ‡¼', name: 'Rwanda' }],
  ['BL', { emoji: 'ğŸ‡§ğŸ‡±', name: 'Saint BarthÃ©lemy' }],
  ['SH', { emoji: 'ğŸ‡¸ğŸ‡­', name: 'Saint Helena' }],
  ['KN', { emoji: 'ğŸ‡°ğŸ‡³', name: 'Saint Kitts and Nevis' }],
  ['LC', { emoji: 'ğŸ‡±ğŸ‡¨', name: 'Saint Lucia' }],
  ['MF', { emoji: 'ğŸ‡²ğŸ‡«', name: 'Saint Martin' }],
  ['PM', { emoji: 'ğŸ‡µğŸ‡²', name: 'Saint Pierre and Miquelon' }],
  ['VC', { emoji: 'ğŸ‡»ğŸ‡¨', name: 'Saint Vincent and the Grenadines' }],
  ['WS', { emoji: 'ğŸ‡¼ğŸ‡¸', name: 'Samoa' }],
  ['SM', { emoji: 'ğŸ‡¸ğŸ‡²', name: 'San Marino' }],
  ['ST', { emoji: 'ğŸ‡¸ğŸ‡¹', name: 'SÃ£o TomÃ© and PrÃ­ncipe' }],
  ['SA', { emoji: 'ğŸ‡¸ğŸ‡¦', name: 'Saudi Arabia' }],
  ['SN', { emoji: 'ğŸ‡¸ğŸ‡³', name: 'Senegal' }],
  ['RS', { emoji: 'ğŸ‡·ğŸ‡¸', name: 'Serbia' }],
  ['SC', { emoji: 'ğŸ‡¸ğŸ‡¨', name: 'Seychelles' }],
  ['SL', { emoji: 'ğŸ‡¸ğŸ‡±', name: 'Sierra Leone' }],
  ['SG', { emoji: 'ğŸ‡¸ğŸ‡¬', name: 'Singapore' }],
  ['SX', { emoji: 'ğŸ‡¸ğŸ‡½', name: 'Sint Maarten' }],
  ['SK', { emoji: 'ğŸ‡¸ğŸ‡°', name: 'Slovakia' }],
  ['SI', { emoji: 'ğŸ‡¸ğŸ‡®', name: 'Slovenia' }],
  ['SB', { emoji: 'ğŸ‡¸ğŸ‡§', name: 'Solomon Islands' }],
  ['SO', { emoji: 'ğŸ‡¸ğŸ‡´', name: 'Somalia' }],
  ['ZA', { emoji: 'ğŸ‡¿ğŸ‡¦', name: 'South Africa' }],
  ['GS', { emoji: 'ğŸ‡¬ğŸ‡¸', name: 'South Georgia and the South Sandwich Islands' }],
  ['KR', { emoji: 'ğŸ‡°ğŸ‡·', name: 'South Korea' }],
  ['SS', { emoji: 'ğŸ‡¸ğŸ‡¸', name: 'South Sudan' }],
  ['ES', { emoji: 'ğŸ‡ªğŸ‡¸', name: 'Spain' }],
  ['LK', { emoji: 'ğŸ‡±ğŸ‡°', name: 'Sri Lanka' }],
  ['SD', { emoji: 'ğŸ‡¸ğŸ‡©', name: 'Sudan' }],
  ['SR', { emoji: 'ğŸ‡¸ğŸ‡·', name: 'Suriname' }],
  ['SJ', { emoji: 'ğŸ‡¸ğŸ‡¯', name: 'Svalbard and Jan Mayen' }],
  ['SZ', { emoji: 'ğŸ‡¸ğŸ‡¿', name: 'Swaziland' }],
  ['SE', { emoji: 'ğŸ‡¸ğŸ‡ª', name: 'Sweden' }],
  ['CH', { emoji: 'ğŸ‡¨ğŸ‡­', name: 'Switzerland' }],
  ['SY', { emoji: 'ğŸ‡¸ğŸ‡¾', name: 'Syria' }],
  ['TW', { emoji: 'ğŸ‡¹ğŸ‡¼', name: 'Taiwan' }],
  ['TJ', { emoji: 'ğŸ‡¹ğŸ‡¯', name: 'Tajikistan' }],
  ['TZ', { emoji: 'ğŸ‡¹ğŸ‡¿', name: 'Tanzania' }],
  ['TH', { emoji: 'ğŸ‡¹ğŸ‡­', name: 'Thailand' }],
  ['TG', { emoji: 'ğŸ‡¹ğŸ‡¬', name: 'Togo' }],
  ['TK', { emoji: 'ğŸ‡¹ğŸ‡°', name: 'Tokelau' }],
  ['TO', { emoji: 'ğŸ‡¹ğŸ‡´', name: 'Tonga' }],
  ['TT', { emoji: 'ğŸ‡¹ğŸ‡¹', name: 'Trinidad and Tobago' }],
  ['TN', { emoji: 'ğŸ‡¹ğŸ‡³', name: 'Tunisia' }],
  ['TR', { emoji: 'ğŸ‡¹ğŸ‡·', name: 'Turkey' }],
  ['TM', { emoji: 'ğŸ‡¹ğŸ‡²', name: 'Turkmenistan' }],
  ['TC', { emoji: 'ğŸ‡¹ğŸ‡¨', name: 'Turks and Caicos Islands' }],
  ['TV', { emoji: 'ğŸ‡¹ğŸ‡»', name: 'Tuvalu' }],
  ['UM', { emoji: 'ğŸ‡ºğŸ‡²', name: 'U.S. Minor Outlying Islands' }],
  ['VI', { emoji: 'ğŸ‡»ğŸ‡®', name: 'U.S. Virgin Islands' }],
  ['UG', { emoji: 'ğŸ‡ºğŸ‡¬', name: 'Uganda' }],
  ['UA', { emoji: 'ğŸ‡ºğŸ‡¦', name: 'Ukraine' }],
  ['AE', { emoji: 'ğŸ‡¦ğŸ‡ª', name: 'United Arab Emirates' }],
  ['GB', { emoji: 'ğŸ‡¬ğŸ‡§', name: 'United Kingdom' }],
  ['US', { emoji: 'ğŸ‡ºğŸ‡¸', name: 'United States' }],
  ['UY', { emoji: 'ğŸ‡ºğŸ‡¾', name: 'Uruguay' }],
  ['UZ', { emoji: 'ğŸ‡ºğŸ‡¿', name: 'Uzbekistan' }],
  ['VU', { emoji: 'ğŸ‡»ğŸ‡º', name: 'Vanuatu' }],
  ['VA', { emoji: 'ğŸ‡»ğŸ‡¦', name: 'Vatican City' }],
  ['VE', { emoji: 'ğŸ‡»ğŸ‡ª', name: 'Venezuela' }],
  ['VN', { emoji: 'ğŸ‡»ğŸ‡³', name: 'Vietnam' }],
  ['WF', { emoji: 'ğŸ‡¼ğŸ‡«', name: 'Wallis and Futuna' }],
  ['EH', { emoji: 'ğŸ‡ªğŸ‡­', name: 'Western Sahara' }],
  ['YE', { emoji: 'ğŸ‡¾ğŸ‡ª', name: 'Yemen' }],
  ['ZM', { emoji: 'ğŸ‡¿ğŸ‡²', name: 'Zambia' }],
  ['ZW', { emoji: 'ğŸ‡¿ğŸ‡¼', name: 'Zimbabwe' }],
] as const

const availableCountries = countries.filter(([countryCode]) =>
  countryWhiteList.includes(countryCode),
)

const CountryPicker = ({
  onSelectCountry,
}: {
  onSelectCountry: (countryCode: string) => void
}) => {
  const onChange = (val: string) => {
    onSelectCountry(val)
    setValue(val)
  }

  const [value, setValue] = useState('US')
  const [open, setOpen] = React.useState(false)

  const currentCountry = availableCountries.find(
    ([countryCode]) => countryCode === value,
  )

  return (
    <Popover open={open} onOpenChange={setOpen}>
      <PopoverTrigger asChild>
        <RawButton
          variant="outline"
          role="combobox"
          aria-expanded={open}
          className="w-full"
        >
          <div className="inline-flex w-full items-center justify-between">
            {currentCountry ? (
              <span className="flex-1  text-left">
                {currentCountry[1].emoji} {currentCountry[1].name}
              </span>
            ) : (
              <span className="flex-1 text-left">Select country</span>
            )}
            <ChevronsUpDown className="ml-2 h-4 w-4 shrink-0 opacity-50" />
          </div>
        </RawButton>
      </PopoverTrigger>
      <PopoverContent
        className="-mt-10 w-[400px] p-0 lg:min-w-[600px]"
        align="start"
      >
        <Command>
          <CommandInput placeholder="Search country..." className="my-2 h-8" />
          <CommandEmpty>No country found.</CommandEmpty>
          <CommandGroup>
            {availableCountries.map(([countryCode, country]) => (
              <CommandItem
                key={countryCode}
                value={country.name}
                onSelect={() => {
                  onChange(countryCode)
                  setOpen(false)
                }}
              >
                <Check
                  className={twMerge(
                    'mr-2 h-4 w-4',
                    value === countryCode ? 'opacity-100' : 'opacity-0',
                  )}
                />
                {country.emoji} {country.name}
              </CommandItem>
            ))}
          </CommandGroup>
        </Command>
      </PopoverContent>
    </Popover>
  )
}

export default CountryPicker
