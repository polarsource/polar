"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("zustand"),r=require("zustand/middleware");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function s(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var u=s(e),o=n(t);const c=u.createContext(null);exports.KeyboardControls=function({map:e,children:t,onChange:n,domElement:s}){const a=e.map((e=>e.name+e.keys)).join("-"),d=u.useMemo((()=>o.default(r.subscribeWithSelector((()=>e.reduce(((e,t)=>({...e,[t.name]:!1})),{}))))),[a]),i=u.useMemo((()=>[d.subscribe,d.getState,d]),[a]),f=d.setState;return u.useEffect((()=>{const t=e.map((({name:e,keys:t,up:r})=>({keys:t,up:r,fn:t=>{f({[e]:t}),n&&n(e,t,i[1]())}}))).reduce(((e,{keys:t,fn:r,up:n=!0})=>(t.forEach((t=>e[t]={fn:r,pressed:!1,up:n})),e)),{}),r=({key:e,code:r})=>{const n=t[e]||t[r];if(!n)return;const{fn:s,pressed:u,up:o}=n;n.pressed=!0,!o&&u||s(!0)},u=({key:e,code:r})=>{const n=t[e]||t[r];if(!n)return;const{fn:s,up:u}=n;n.pressed=!1,u&&s(!1)},o=s||window;return o.addEventListener("keydown",r,{passive:!0}),o.addEventListener("keyup",u,{passive:!0}),()=>{o.removeEventListener("keydown",r),o.removeEventListener("keyup",u)}}),[s,a]),u.createElement(c.Provider,{value:i,children:t})},exports.useKeyboardControls=function(e){const[t,r,n]=u.useContext(c);return e?n(e):[t,r]};
